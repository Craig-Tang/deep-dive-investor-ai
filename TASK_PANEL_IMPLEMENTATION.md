# 任务栏功能实现总结

## 功能概述

为Deep Dive Investor AI应用添加了投研任务管理功能，**任务面板仅在首页显示**，右侧展示老板和个人的投研任务栏。智研报告和智选模式保持原有的两栏布局（新闻+AI摘要）。

## 布局调整

### 首页布局（Home）
- **左侧主内容**：新闻卡片展示区域，占据大部分空间
- **右侧任务栏**：固定宽度320px（w-80），显示投研任务
- **底部输入框**：调整右边距，避免与任务栏重叠（right-80）

### 智研报告/智选模式
- **保持原有布局**：新闻区域 + AI摘要区域的两栏布局
- **任务栏隐藏**：`showTasks={false}`，不显示任务相关功能
- **比例恢复**：新闻区域恢复到2/5（40%）的占比

## 新增文件

### 1. 数据层 (`src/data/tasks.ts`)
- **Task接口**: 定义任务的完整数据结构
- **TaskGroup接口**: 任务分组结构（老板分配 vs 个人任务）
- **mockTasks**: 丰富的任务mock数据，包含不同状态、优先级、类型的任务
- **工具函数**:
  - `getTaskGroups()`: 按分配者分组任务
  - `getTaskStats()`: 计算任务统计信息
  - `sortTasks()`: 任务排序逻辑

### 2. 组件层
#### `src/components/TaskPanel.tsx`
- **主任务面板组件**: 完整的任务列表展示
- **TaskItem组件**: 单个任务项展示，包含状态、优先级、进度、截止时间等
- **TaskGroupHeader组件**: 任务组标题，显示统计信息
- **特性**:
  - 任务状态可视化（图标+颜色）
  - 优先级标识
  - 进度条（进行中任务）
  - 截止时间倒计时
  - 相关关键词展示
  - 任务分组展开/收起

#### `src/components/TaskDetailModal.tsx`
- **任务详情弹窗**: 点击任务后显示完整信息
- **功能**:
  - 任务完整信息展示
  - 相关关键词和公司
  - 时间信息（创建、截止、完成）
  - 任务状态切换按钮
  - 编辑/删除操作（预留接口）

### 3. 布局调整
#### `src/pages/Index.tsx`
- **首页布局重构**: 
  - 主内容区域（flex-1）：新闻卡片展示
  - 右侧任务栏（w-80）：固定320px宽度的任务面板
  - 输入框调整：right-80避免与任务栏重叠
- **任务状态管理**: 任务详情弹窗状态和处理逻辑
- **条件渲染**: 任务面板仅在首页显示

#### `src/components/NewsChatLayout.tsx`
- **恢复两栏布局**: 移除任务栏相关的三栏布局
- **兼容性保持**: 保留任务相关Props以维持向后兼容
- **默认配置**: `showTasks={false}`，默认不显示任务功能
- **布局比例**: 新闻区域恢复到2/5（40%）占比

## 数据结构

### Task接口
```typescript
interface Task {
  id: string;
  title: string;
  description: string;
  priority: 'high' | 'medium' | 'low';
  status: 'pending' | 'in-progress' | 'completed' | 'overdue';
  assignedBy: 'boss' | 'self';
  category: 'research' | 'analysis' | 'report' | 'monitoring' | 'meeting';
  deadline?: Date;
  createdAt: Date;
  estimatedHours?: number;
  completedAt?: Date;
  relatedKeywords?: string[];
  relatedCompanies?: string[];
  progress?: number; // 0-100
}
```

## Mock数据特色

1. **真实场景**: 基于投研工作实际情况设计任务
2. **状态多样**: 包含待开始、进行中、已完成、已逾期等状态
3. **优先级分级**: 高/中/低优先级任务
4. **类型丰富**: 研究、分析、报告、监控、会议等类型
5. **时间管理**: 创建时间、截止时间、完成时间
6. **关联信息**: 相关关键词、公司信息

## 界面特性

### 任务栏设计
- **紧凑布局**: 适应较窄的侧边栏空间
- **信息层次**: 标题-描述-进度-底部信息的清晰层次
- **状态可视化**: 图标+颜色直观表示任务状态
- **交互友好**: 悬停效果、点击查看详情

### 响应式适配
- **小屏优化**: 图标、字体、间距适配小尺寸
- **滚动区域**: 内容超出时支持滚动
- **弹性布局**: 支持不同屏幕尺寸

## 技术实现

### 组件设计
- **组合模式**: TaskPanel组合TaskItem和TaskGroupHeader
- **Props透传**: 灵活的事件处理回调
- **样式系统**: 基于shadcn/ui的一致性设计

### 状态管理
- **本地状态**: 展开/收起状态
- **Props驱动**: 数据通过props传递
- **事件冒泡**: 点击事件层层传递到页面级

### 性能优化
- **排序逻辑**: 按状态-优先级-截止时间智能排序
- **条件渲染**: 根据任务状态有条件显示元素
- **样式缓存**: 使用cn()函数优化样式计算

## 扩展点

### 数据持久化
- 集成后端API进行任务CRUD操作
- 任务状态实时同步
- 任务历史记录

### 功能增强
- 任务搜索和筛选
- 任务优先级自动调整
- 任务时间统计和报表
- 任务提醒和通知
- 子任务和任务依赖

### UI改进
- 拖拽排序任务
- 批量操作任务
- 任务看板视图
- 时间轴视图

## 使用说明

1. **查看任务**: 仅在首页右侧显示任务栏
2. **任务分组**: 默认按"老板分配"和"个人任务"分组
3. **任务详情**: 点击任务项查看详细信息
4. **状态管理**: 在详情弹窗中可切换任务状态
5. **添加任务**: 点击任务栏右上角"+"按钮（待实现）
6. **模式切换**: 进入智研报告或智选模式时，任务栏自动隐藏

## 布局优势

### 首页专注任务管理
- **任务可见性**: 首页右侧固定显示，用户进入即可查看任务状态
- **空间利用**: 320px固定宽度，既保证信息展示，又不占用过多空间
- **交互便捷**: 任务管理与新闻浏览可以同时进行

### 工作模式专注内容
- **界面简洁**: 智研报告和智选模式保持原有布局，专注于内容分析
- **空间最大化**: AI摘要区域获得更多空间，提升分析体验
- **操作流畅**: 减少界面元素干扰，提升工作效率

## 注意事项

- 当前为mock数据，需要集成真实后端
- 任务状态切换逻辑需要完善
- 添加任务功能待开发
- 考虑增加任务分配和协作功能
